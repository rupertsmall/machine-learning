<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Machine-learning by rupertsmall</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Machine-learning</h1>
      <h2 class="project-tagline">machine learning algorithms</h2>
      <a href="https://github.com/rupertsmall/machine-learning" class="btn">View on GitHub</a>
      <a href="https://github.com/rupertsmall/machine-learning/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/rupertsmall/machine-learning/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="k-means-clustering" class="anchor" href="#k-means-clustering" aria-hidden="true"><span class="octicon octicon-link"></span></a>K-means clustering</h3>

<p>K-means clustering is one of many machine learning models which challenges a computer to discover some feature of the data "by itself". Here the feature is the property of belonging to a certain group or cluster. Data with 5 clusters may look something like this:</p>

<p><img src="https://cloud.githubusercontent.com/assets/7373621/8417723/38990686-1ea6-11e5-9398-a787e6e21f7f.jpg" alt="data clusters"></p>

<p>This is just randomly generated synthetic data generated using <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/create_k_cluster.m">create_k_cluster.m</a>. Although its simple to see using the human eye where the clusters are, the goal is to teach the computer how to identify any clusters that may be presented to it without the aid of a human being. To begin we need the computer to understand how to generate some guesses for where the clusters lie: how to algorithmically select a point from each cluster? One possibility is <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/seed_k_means.m">seed_k_means.m</a> which places a rectangular grid over the data and keeps only those points on the grid which are close to the real cluster data (plotted above). The data is randomly generated so the specific plots will look different for you. An example looks like this:</p>

<p><img src="https://cloud.githubusercontent.com/assets/7373621/8417724/38a2d58a-1ea6-11e5-88cc-8ade65a6171d.jpg" alt="clusters with seed guesses"></p>

<p>Here the big black dots are the computer's guesses for where the clusters are and the small coloured dots are the actual data clusters. We ultimately want the computer to identify the clusters by drawing circles around them for example. We want the number of initial guesses to be slightly more than K=5 to ensure the computer makes at least one correct guess for each cluster. As you can see there's alot of white space where the algorithm (rightly) doesn't make any guesses, because there are no real data points there.</p>

<h3>
<a id="running-the-code" class="anchor" href="#running-the-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running the Code</h3>

<p>The functions <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/create_k_cluster.m">create_k_cluster.m</a> and <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/seed_k_means.m">seed_k_means.m</a> are called by <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/k_means_plot.m">k_means_plot.m</a>. Notice in <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/seed_k_means.m">seed_k_means.m</a> there are no <em>for</em> loops ! Optimising the distance between guesses and the real cluster data is all done using matrix algebra which Matlab/Octave does extremely fast:</p>

<pre><code>[x_candidates y_candidates] = meshgrid(xmin:delta_x:xmax, ymin:delta_y:ymax);
x_candidates = reshape(x_candidates, NN+2*N+1,1);
y_candidates = reshape(y_candidates, NN+2*N+1,1);
xx = x_candidates.^2;
yy = y_candidates.^2;

xdot = kron(X./(XX + YY), x_candidates./(xx+yy));
ydot = kron(Y./(XX + YY), y_candidates./(xx+yy));
xdist = kron(exp(X),exp(-x_candidates)).^2;
ydist = kron(exp(Y),exp(-y_candidates)).^2;
dist = ((xdist+ydist)/2 - 1).^2;
dot = xdot + ydot -1;
dot = dot.^2;
measure = dist.*dot;
measure = reshape(measure, length(x_candidates), length(X));
[closest index] = min(measure);
</code></pre>

<p>Another example of using matrix operations instead of <em>for</em> loops can be seen in <a href="https://github.com/rupertsmall/distance-heat-maps/blob/master/get_min_perp.m">this program</a> for calculating the minimum perpendicular distance between all points in a plane and a curve passing through the plane (see <a href="http://rupertsmall.github.io/distance-heat-maps/">here</a> for plots)</p>

<h2>
<a id="k-means-clustering-1" class="anchor" href="#k-means-clustering-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>K-means Clustering</h2>

<p>Now that we have figured out a way to generate the seed guesses for the K-means algorithm we can feed this into the actual algorithm, <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/k_means.m">k_means.m</a>. Note the above examples had K=5 and N=10, so we had many guesses (31 in fact) for the number of clusters, much more than 5. If we do this however and run <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/k_means.m">k_means.m</a> we would get something like the following for the seed guesses
<img src="https://cloud.githubusercontent.com/assets/7373621/8439792/2a1bf8f0-1f66-11e5-9016-6b7969ee74c0.jpg" alt="seed K=5 N=7">
and something like this for the actual K-means search:
<img src="https://cloud.githubusercontent.com/assets/7373621/8439799/3377c00a-1f66-11e5-9a74-5a8fe94401db.jpg" alt="K-means K=5, N=7">
where the stars indicate where the algorithm thinks the centre of mass of the clusters are. But the algorithm has assumed that <em>too many</em> centres of mass exist - we know there are only five ! (and there are more than 5 stars for sure). To fix this we need to reduce N in <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/k_means.m">k_means.m</a>. Setting K=5, N=2 for example gives the following seed guesses
<img src="https://cloud.githubusercontent.com/assets/7373621/8439791/2a15dfb0-1f66-11e5-92b9-a4823ec9a397.jpg" alt="Seed guesses with K=5, N=2">
and the following K-means search:
<img src="https://cloud.githubusercontent.com/assets/7373621/8439798/33759e9c-1f66-11e5-8abf-8da9ed033304.jpg" alt="K-means K=5, N=2">
So the algorithm found the centres of mass, but the seed guesses for lower N were <em>much</em> worse than for higher N. In fact, the algorithm was very lucky to find the correct centres of mass for each cluster given how bad the initial guesses were (and if you run the algorithm a few times you will see that there's not always such a happy ending). So we can see that <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/k_means.m">k_means.m</a> does it's job fine, but that the initial seed guesses provided by <a href="https://github.com/rupertsmall/machine-learning/blob/master/K-means-clustering/seed_k_means.m">seed_k_means.m</a> can be problematic. Can you think of a way to improve the code to provide better seed guesses?</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/rupertsmall/machine-learning">Machine-learning</a> is maintained by <a href="https://github.com/rupertsmall">rupertsmall</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

